<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2d7a3e">
    <meta name="description" content="å›½é“ã‚¹ãƒ†ãƒƒã‚«ãƒ¼å–å¾—è¨˜éŒ²ã‚¢ãƒ—ãƒª">
    
    <title>å›½é“ã‚¹ãƒ†ãƒƒã‚«ãƒ¼è¨˜éŒ²</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- App CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><rect fill='%232d7a3e' width='192' height='192'/><text x='50%' y='50%' font-size='100' font-weight='bold' fill='white' text-anchor='middle' dominant-baseline='middle'>ğŸš—</text></svg>">
</head>
<body>
    <div id="app">
        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <nav class="navbar">
            <div class="navbar-brand">
                <span class="logo">ğŸ›£ï¸ å›½é“ã‚¹ãƒ†ãƒƒã‚«ãƒ¼</span>
            </div>
            <div class="nav-tabs">
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'add' }"
                    @click="currentTab = 'add'">
                    è¿½åŠ 
                </button>
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'list' }"
                    @click="currentTab = 'list'">
                    ãƒªã‚¹ãƒˆ ({{ stickers.length }})
                </button>
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'map' }"
                    @click="currentTab = 'map'">
                    åœ°å›³
                </button>
            </div>
        </nav>

        <!-- è¿½åŠ ãƒ‘ãƒãƒ« -->
        <div v-if="currentTab === 'add'" class="panel add-panel">
            <h2>æ–°ã—ã„ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã‚’è¨˜éŒ²</h2>
            
            <form @submit.prevent="addSticker" class="form">
                <div class="form-group">
                    <label>å›½é“ç•ªå· *</label>
                    <input 
                        v-model="form.roadNumber" 
                        type="number" 
                        min="1" 
                        max="999"
                        placeholder="ä¾‹: 4"
                        required>
                </div>

                <div class="form-group">
                    <label>å–å¾—æ—¥ *</label>
                    <input 
                        v-model="form.date" 
                        type="date"
                        required>
                </div>

                <div class="form-group">
                    <label>å–å¾—å ´æ‰€</label>
                    <input 
                        v-model="form.location" 
                        type="text"
                        placeholder="ä¾‹: é’æ£®çœŒå¼˜å‰å¸‚">
                </div>

                <div class="form-group">
                    <label>ç·¯åº¦</label>
                    <input 
                        v-model.number="form.latitude" 
                        type="number"
                        step="0.000001"
                        placeholder="ä¾‹: 40.604">
                </div>

                <div class="form-group">
                    <label>çµŒåº¦</label>
                    <input 
                        v-model.number="form.longitude" 
                        type="number"
                        step="0.000001"
                        placeholder="ä¾‹: 140.6235">
                </div>

                <div class="form-group">
                    <label>å†™çœŸ</label>
                    <input 
                        type="file" 
                        accept="image/*"
                        @change="handleImageUpload"
                        class="file-input">
                    <div v-if="form.image" class="image-preview">
                        <img :src="form.image" alt="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">
                        <button type="button" @click="form.image = null" class="remove-btn">å‰Šé™¤</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>ãƒ¡ãƒ¢</label>
                    <textarea 
                        v-model="form.memo"
                        placeholder="ãã®ä»–ã®æƒ…å ±ã‚’å…¥åŠ›..."
                        rows="3"></textarea>
                </div>

                <button type="submit" class="btn btn-primary">è¨˜éŒ²ã™ã‚‹</button>
            </form>
        </div>

        <!-- ãƒªã‚¹ãƒˆãƒ‘ãƒãƒ« -->
        <div v-if="currentTab === 'list'" class="panel list-panel">
            <h2>è¨˜éŒ²æ¸ˆã¿ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ä¸€è¦§</h2>
            
            <div v-if="stickers.length === 0" class="empty-state">
                <p>ã¾ã ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
            </div>

            <div v-else class="filters">
                <input 
                    v-model="searchQuery"
                    type="text"
                    placeholder="å›½é“ç•ªå·ã§æ¤œç´¢..."
                    class="search-input">
            </div>

            <div class="sticker-list">
                <div 
                    v-for="sticker in filteredStickers" 
                    :key="sticker.id"
                    class="sticker-card">
                    
                    <div class="card-header">
                        <h3>å›½é“ {{ sticker.roadNumber }} å·</h3>
                        <button @click="deleteSticker(sticker.id)" class="delete-btn">Ã—</button>
                    </div>

                    <div class="card-body">
                        <p><strong>å–å¾—æ—¥:</strong> {{ formatDate(sticker.date) }}</p>
                        <p v-if="sticker.location"><strong>å ´æ‰€:</strong> {{ sticker.location }}</p>
                        
                        <div v-if="sticker.image" class="card-image">
                            <img :src="sticker.image" :alt="'å›½é“' + sticker.roadNumber">
                        </div>

                        <p v-if="sticker.memo" class="memo">{{ sticker.memo }}</p>

                        <button 
                            v-if="sticker.latitude && sticker.longitude"
                            @click="goToMap(sticker)"
                            class="btn btn-secondary">
                            åœ°å›³ã§è¡¨ç¤º
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- åœ°å›³ãƒ‘ãƒãƒ« -->
        <div v-if="currentTab === 'map'" class="panel map-panel">
            <h2>ã‚¹ãƒ†ãƒƒã‚«ãƒ¼å–å¾—åœ°ç‚¹</h2>
            <div id="map" class="map-container"></div>
            
            <div v-if="selectedMapMarker" class="map-info">
                <h4>å›½é“ {{ selectedMapMarker.roadNumber }} å·</h4>
                <p>{{ formatDate(selectedMapMarker.date) }}</p>
                <p v-if="selectedMapMarker.location">{{ selectedMapMarker.location }}</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
</body>
</html>
